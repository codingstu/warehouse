{"remainingRequest":"D:\\Study\\vue\\bishe\\warehouse-management-system\\management-system\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\Study\\vue\\bishe\\warehouse-management-system\\management-system\\src\\views\\AccountManage\\ChangePassword.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\Study\\vue\\bishe\\warehouse-management-system\\management-system\\src\\views\\AccountManage\\ChangePassword.vue","mtime":1646716328328},{"path":"D:\\Study\\vue\\bishe\\warehouse-management-system\\management-system\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1624891997656},{"path":"D:\\Study\\vue\\bishe\\warehouse-management-system\\management-system\\node_modules\\babel-loader\\lib\\index.js","mtime":1633574065756},{"path":"D:\\Study\\vue\\bishe\\warehouse-management-system\\management-system\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1624891997656},{"path":"D:\\Study\\vue\\bishe\\warehouse-management-system\\management-system\\node_modules\\vue-loader\\lib\\index.js","mtime":1646716386708}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQovLyDlvJXlhaXosIPnlKjmjqXlj6Plh73mlbANCmltcG9ydCB7IGNoZWNrT2xkUHdkLCBlZGl0UGFzc3dvcmQgfSBmcm9tICJAL2FwaS9hY2NvdW50IjsNCi8vIOW8leWFpeW3peWFt+WHveaVsA0KaW1wb3J0IHsgcHdkUmVnIH0gZnJvbSAiQC91dGlscy9yZWciOw0KaW1wb3J0IGxvY2FsIGZyb20gIkAvdXRpbHMvc2Vzc2lvbiI7DQoNCmV4cG9ydCBkZWZhdWx0IHsNCiAgZGF0YSgpIHsNCiAgICAvLyDml6flr4bnoIHoh6rlrprkuYnpqozor4ENCiAgICBjb25zdCB2YWxpZGF0ZU9sZFB3ZCA9IGFzeW5jIChydWxlLCB2YWx1ZSwgY2FsbGJhY2spID0+IHsNCiAgICAgIC8vIOWPkemAgeivt+axgiDpqozor4Hml6flr4bnoIHmmK/lkKbmraPnoa4NCiAgICAgIGxldCB7IGNvZGUsIG1zZyB9ID0gYXdhaXQgY2hlY2tPbGRQd2QoeyBvbGRQd2Q6IHZhbHVlIH0pOw0KDQogICAgICBpZiAoIXZhbHVlKSB7DQogICAgICAgIGNhbGxiYWNrKG5ldyBFcnJvcigi6K+36L6T5YWl5Y6f5a+G56CBIikpOw0KICAgICAgfSBlbHNlIGlmIChjb2RlID09PSAiMTEiKSB7DQogICAgICAgIGNhbGxiYWNrKG5ldyBFcnJvcihtc2cpKTsgLy8g5pen5a+G56CB6ZSZ6K+vDQogICAgICB9IGVsc2Ugew0KICAgICAgICBjYWxsYmFjaygpOyAvLyDmiJDlip8NCiAgICAgIH0NCiAgICB9Ow0KDQogICAgLy8g5paw55qE5a+G56CB6Ieq5a6a5LmJ6aqM6K+BDQogICAgY29uc3QgdmFsaWRhdGVOZXdQd2QgPSAocnVsZSwgdmFsdWUsIGNhbGxiYWNrKSA9PiB7DQogICAgICBpZiAoIXZhbHVlKSB7DQogICAgICAgIGNhbGxiYWNrKG5ldyBFcnJvcigi6K+36L6T5YWl5paw5a+G56CBIikpOw0KICAgICAgfSBlbHNlIGlmICh2YWx1ZSA9PT0gdGhpcy5wYXNzd29yZE1vZGlmeUZvcm0ub2xkUHdkKSB7DQogICAgICAgIGNhbGxiYWNrKG5ldyBFcnJvcigi5LiN6IO95ZKM5Y6f5a+G56CB55u45ZCMIikpOw0KICAgICAgfSBlbHNlIGlmICghcnVsZS5wYXR0ZXJuLnRlc3QodmFsdWUpKSB7DQogICAgICAgIGNhbGxiYWNrKG5ldyBFcnJvcigi5a+G56CB55Sx5pWw5a2X5ZKM5a2X5q+N57uE5oiQ77yM6ZW/5bqmNi0xMuS9jSIpKTsNCiAgICAgIH0gZWxzZSB7DQogICAgICAgIC8vIOWmguaenOehruiupOaWsOWvhueggeS4jeS4uuepug0KICAgICAgICBpZiAodGhpcy5wYXNzd29yZE1vZGlmeUZvcm0uY2hlY2tQYXNzICE9PSAiIikgew0KICAgICAgICAgIHRoaXMuJHJlZnMucGFzc3dvcmRNb2RpZnlGb3JtLnZhbGlkYXRlRmllbGQoImNoZWNrUGFzcyIpOyAvLyDlho3mrKHop6blj5Hmn5DkuKrigJzlrZfmrrXigJ3nmoTpqozor4ENCiAgICAgICAgfQ0KICAgICAgICBjYWxsYmFjaygpOw0KICAgICAgfQ0KICAgIH07DQoNCiAgICAvLyDpqozor4Hnoa7orqTmlrDlr4bnoIENCiAgICBjb25zdCB2YWxpZGF0ZUNoZWNrUGFzcyA9IChydWxlLCB2YWx1ZSwgY2FsbGJhY2spID0+IHsNCiAgICAgIGlmICghdmFsdWUpIHsNCiAgICAgICAgY2FsbGJhY2sobmV3IEVycm9yKCLor7flho3mrKHovpPlhaXmlrDlr4bnoIEiKSk7DQogICAgICB9IGVsc2UgaWYgKHZhbHVlICE9PSB0aGlzLnBhc3N3b3JkTW9kaWZ5Rm9ybS5uZXdQd2QpIHsNCiAgICAgICAgY2FsbGJhY2sobmV3IEVycm9yKCLkuKTmrKHlr4bnoIHkuI3kuIDoh7QiKSk7DQogICAgICB9IGVsc2Ugew0KICAgICAgICBjYWxsYmFjaygpOw0KICAgICAgfQ0KICAgIH07DQoNCiAgICByZXR1cm4gew0KICAgICAgLy8g6KGo5Y2V5pWw5o2uDQogICAgICBwYXNzd29yZE1vZGlmeUZvcm06IHsNCiAgICAgICAgb2xkUHdkOiAiIiwNCiAgICAgICAgbmV3UHdkOiAiIiwNCiAgICAgICAgY2hlY2tQYXNzOiAiIiwNCiAgICAgIH0sDQogICAgICAvLyDpqozor4Hop4TliJkNCiAgICAgIHJ1bGVzOiB7DQogICAgICAgIG9sZFB3ZDogeyByZXF1aXJlZDogdHJ1ZSwgdmFsaWRhdG9yOiB2YWxpZGF0ZU9sZFB3ZCwgdHJpZ2dlcjogImJsdXIiIH0sIC8vIOaXp+WvhueggemqjOivgQ0KICAgICAgICAvLyDmlrDlr4bnoIHpqozor4ENCiAgICAgICAgbmV3UHdkOiB7DQogICAgICAgICAgcmVxdWlyZWQ6IHRydWUsDQogICAgICAgICAgcGF0dGVybjogcHdkUmVnKCksDQogICAgICAgICAgdmFsaWRhdG9yOiB2YWxpZGF0ZU5ld1B3ZCwNCiAgICAgICAgICB0cmlnZ2VyOiAiYmx1ciIsDQogICAgICAgIH0sDQogICAgICAgIC8vIOmqjOivgeehruiupOaWsOWvhueggQ0KICAgICAgICBjaGVja1Bhc3M6IHsNCiAgICAgICAgICByZXF1aXJlZDogdHJ1ZSwNCiAgICAgICAgICB2YWxpZGF0b3I6IHZhbGlkYXRlQ2hlY2tQYXNzLA0KICAgICAgICAgIHRyaWdnZXI6ICJibHVyIiwNCiAgICAgICAgfSwgLy8g5pen5a+G56CB6aqM6K+BDQogICAgICB9LA0KICAgIH07DQogIH0sDQogIG1ldGhvZHM6IHsNCiAgICAvLyDooajljZXmj5DkuqQNCiAgICBzdWJtaXRGb3JtKCkgew0KICAgICAgLy8g6YCJ5Lit5pW05Liq6KGo5Y2VIOinpuWPkeaJgOaciemqjOivgSDlpoLmnpzpg73pgJrov4cgdmFsaWTlsLHmmK90cnVlIOWQpuWImeWwseaYr2ZhbHNlDQogICAgICB0aGlzLiRyZWZzLnBhc3N3b3JkTW9kaWZ5Rm9ybS52YWxpZGF0ZShhc3luYyAodmFsaWQpID0+IHsNCiAgICAgICAgaWYgKHZhbGlkKSB7DQogICAgICAgICAgbGV0IHsgY29kZSB9ID0gYXdhaXQgZWRpdFBhc3N3b3JkKHsNCiAgICAgICAgICAgIG5ld1B3ZDogdGhpcy5wYXNzd29yZE1vZGlmeUZvcm0ubmV3UHdkLA0KICAgICAgICAgIH0pOw0KDQogICAgICAgICAgaWYgKGNvZGUgPT09IDApIHsNCiAgICAgICAgICAgIC8vIOa4hemZpHRva2VuDQogICAgICAgICAgICBsb2NhbC5yZW1vdmUoInRva2VuIik7DQogICAgICAgICAgICAvLyDot7PovazliLDnmbvlvZXpobXpnaINCiAgICAgICAgICAgIHRoaXMuJHJvdXRlci5wdXNoKCIvbG9naW4iKTsNCiAgICAgICAgICB9DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICB9DQogICAgICB9KTsNCiAgICB9LA0KICB9LA0KfTsNCg=="},{"version":3,"sources":["ChangePassword.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAwDA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"ChangePassword.vue","sourceRoot":"src/views/AccountManage","sourcesContent":["<template>\r\n  <div class=\"password-modify\">\r\n    <el-card class=\"box-card\">\r\n      <!-- 面板头部 -->\r\n      <div slot=\"header\" class=\"clearfix\">\r\n        <span>账号添加</span>\r\n      </div>\r\n      <!-- 表单 -->\r\n      <div>\r\n        <el-form\r\n          style=\"width: 315px;\"\r\n          size=\"small\"\r\n          status-icon\r\n          ref=\"passwordModifyForm\"\r\n          label-width=\"100px\"\r\n          :model=\"passwordModifyForm\"\r\n          :rules=\"rules\"\r\n        >\r\n          <!-- 旧密码 -->\r\n          <el-form-item label=\"旧的密码\" prop=\"oldPwd\">\r\n            <el-input\r\n              v-model=\"passwordModifyForm.oldPwd\"\r\n              type=\"text\"\r\n              autocomplete=\"off\"\r\n            ></el-input>\r\n          </el-form-item>\r\n\r\n          <!-- 新密码 -->\r\n          <el-form-item label=\"新的密码\" prop=\"newPwd\">\r\n            <el-input\r\n              v-model=\"passwordModifyForm.newPwd\"\r\n              type=\"text\"\r\n              autocomplete=\"off\"\r\n            ></el-input>\r\n          </el-form-item>\r\n\r\n          <!-- 确认新密码 -->\r\n          <el-form-item label=\"确认新密码\" prop=\"checkPass\">\r\n            <el-input\r\n              v-model=\"passwordModifyForm.checkPass\"\r\n              type=\"text\"\r\n              autocomplete=\"off\"\r\n            ></el-input>\r\n          </el-form-item>\r\n\r\n          <!-- 提交按钮 -->\r\n          <el-form-item>\r\n            <el-button type=\"primary\" @click=\"submitForm\">提交</el-button>\r\n          </el-form-item>\r\n        </el-form>\r\n      </div>\r\n    </el-card>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\n// 引入调用接口函数\r\nimport { checkOldPwd, editPassword } from \"@/api/account\";\r\n// 引入工具函数\r\nimport { pwdReg } from \"@/utils/reg\";\r\nimport local from \"@/utils/session\";\r\n\r\nexport default {\r\n  data() {\r\n    // 旧密码自定义验证\r\n    const validateOldPwd = async (rule, value, callback) => {\r\n      // 发送请求 验证旧密码是否正确\r\n      let { code, msg } = await checkOldPwd({ oldPwd: value });\r\n\r\n      if (!value) {\r\n        callback(new Error(\"请输入原密码\"));\r\n      } else if (code === \"11\") {\r\n        callback(new Error(msg)); // 旧密码错误\r\n      } else {\r\n        callback(); // 成功\r\n      }\r\n    };\r\n\r\n    // 新的密码自定义验证\r\n    const validateNewPwd = (rule, value, callback) => {\r\n      if (!value) {\r\n        callback(new Error(\"请输入新密码\"));\r\n      } else if (value === this.passwordModifyForm.oldPwd) {\r\n        callback(new Error(\"不能和原密码相同\"));\r\n      } else if (!rule.pattern.test(value)) {\r\n        callback(new Error(\"密码由数字和字母组成，长度6-12位\"));\r\n      } else {\r\n        // 如果确认新密码不为空\r\n        if (this.passwordModifyForm.checkPass !== \"\") {\r\n          this.$refs.passwordModifyForm.validateField(\"checkPass\"); // 再次触发某个“字段”的验证\r\n        }\r\n        callback();\r\n      }\r\n    };\r\n\r\n    // 验证确认新密码\r\n    const validateCheckPass = (rule, value, callback) => {\r\n      if (!value) {\r\n        callback(new Error(\"请再次输入新密码\"));\r\n      } else if (value !== this.passwordModifyForm.newPwd) {\r\n        callback(new Error(\"两次密码不一致\"));\r\n      } else {\r\n        callback();\r\n      }\r\n    };\r\n\r\n    return {\r\n      // 表单数据\r\n      passwordModifyForm: {\r\n        oldPwd: \"\",\r\n        newPwd: \"\",\r\n        checkPass: \"\",\r\n      },\r\n      // 验证规则\r\n      rules: {\r\n        oldPwd: { required: true, validator: validateOldPwd, trigger: \"blur\" }, // 旧密码验证\r\n        // 新密码验证\r\n        newPwd: {\r\n          required: true,\r\n          pattern: pwdReg(),\r\n          validator: validateNewPwd,\r\n          trigger: \"blur\",\r\n        },\r\n        // 验证确认新密码\r\n        checkPass: {\r\n          required: true,\r\n          validator: validateCheckPass,\r\n          trigger: \"blur\",\r\n        }, // 旧密码验证\r\n      },\r\n    };\r\n  },\r\n  methods: {\r\n    // 表单提交\r\n    submitForm() {\r\n      // 选中整个表单 触发所有验证 如果都通过 valid就是true 否则就是false\r\n      this.$refs.passwordModifyForm.validate(async (valid) => {\r\n        if (valid) {\r\n          let { code } = await editPassword({\r\n            newPwd: this.passwordModifyForm.newPwd,\r\n          });\r\n\r\n          if (code === 0) {\r\n            // 清除token\r\n            local.remove(\"token\");\r\n            // 跳转到登录页面\r\n            this.$router.push(\"/login\");\r\n          }\r\n        } else {\r\n          return false;\r\n        }\r\n      });\r\n    },\r\n  },\r\n};\r\n</script>\r\n\r\n<style lang=\"less\" scoped></style>\r\n"]}]}